@echo off
title Silent Hill 3 PC Sound Pitch Fixer
setlocal enableextensions
pushd "%~dp0"

if not exist "data\sound\" (
	echo Script is not in game's root dir!
	echo Cannot proceed.
	pause> nul
	exit
)

echo Freq. multiplier: 1,0884
echo.

for %%m in (
	"data\sound\sd.afs"
	"data\sound\demo_afs\wav.afs"
	"data\sound\newv_afs\wav.afs"
) do if exist "%%~m" (
	echo Fixing %%~m

rem echo - making backup...
	if not exist "%%~dpnm.bak" (
		copy "%%~m" "%%~dpnm.bak"> nul
	)

echo - converting 22050 to 24000 [352/384 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D742010000000010001002256000044AC0000|57415645666D74201000000001000100C05D000080BB0000|" -quiet=2 -yes

echo - converting 22050 to 24000 [705/768 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D742010000000010002002256000088580100|57415645666D74201000000001000200C05D000000770100|" -quiet=2 -yes

echo - converting 24585 to 26760 [393/428 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D742010000000010001000960000012C00000|57415645666D742010000000010001008868000010D10000|" -quiet=2 -yes

echo - converting 25200 to 27428 [403/438 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D7420100000000100010070620000E0C40000|57415645666D74201000000001000100246B000048D60000|" -quiet=2 -yes

echo - converting 25233 to 27464 [403/439 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D742010000000010001009162000022C50000|57415645666D74201000000001000100486B000090D60000|" -quiet=2 -yes

echo - converting 25254 to 27488 [404/440 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D74201000000001000100A66200004CC50000|57415645666D74201000000001000100606B0000C0D60000|" -quiet=2 -yes

echo - converting 28471 to 30988 [455/495 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D74201000000001000100376F00006EDE0000|57415645666D742010000000010001000C79000018F20000|" -quiet=2 -yes

echo - converting 28524 to 31046 [456/496 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D742010000000010001006C6F0000D8DE0000|57415645666D74201000000001000100467900008CF20000|" -quiet=2 -yes

echo - converting 32000 to 34830 [512/557 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D74201000000001000100007D000000FA0000|57415645666D742010000000010001000E8800001C100100|" -quiet=2 -yes

echo - converting 32000 to 34830 [1024/1114 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D74201000000001000200007D000000F40100|57415645666D742010000000010002000E88000038200200|" -quiet=2 -yes

echo - converting 32513 to 35388 [1040/1132 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D74201000000001000200017F000004FC0100|57415645666D742010000000010002003C8A0000F0280200|" -quiet=2 -yes

echo - converting 35203 to 38316 [563/613 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D742010000000010001008389000006130100|57415645666D74201000000001000100AC950000582B0100|" -quiet=2 -yes

echo - converting 44100 to 48000 [705/768 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D7420100000000100010044AC000088580100|57415645666D7420100000000100010080BB000000770100|" -quiet=2 -yes

echo - converting 44100 to 48000 [1411/1536 kbps]
	"%~n0.exe" replace "%%~m" -binary "|57415645666D7420100000000100020044AC000010B10200|57415645666D7420100000000100020080BB000000EE0200|" -quiet=2 -yes

echo - fixing short-length files issue...
	rem sd_00074.wav
	"%~n0.exe" replace "%%~m" -binary "|52494646101A000057415645666D74201000000001000100C05D000080BB0000|52494646101A000057415645666D742010000000010001002256000044AC0000|" -quiet=2 -yes
	rem sd_00055.wav
	"%~n0.exe" replace "%%~m" -binary "|52494646141A000057415645666D74201000000001000100C05D000080BB0000|52494646141A000057415645666D742010000000010001002256000044AC0000|" -quiet=2 -yes
	rem sd_00183.wav
	"%~n0.exe" replace "%%~m" -binary "|52494646801A000057415645666D74201000000001000100C05D000080BB0000|52494646801A000057415645666D742010000000010001002256000044AC0000|" -quiet=2 -yes
	rem sd_00037.wav
	"%~n0.exe" replace "%%~m" -binary "|52494646D21F000057415645666D74201000000001000100606B0000C0D60000|52494646D21F000057415645666D74201000000001000100A66200004CC50000|" -quiet=2 -yes
	rem sd_00041.wav
	"%~n0.exe" replace "%%~m" -binary "|524946462A22000057415645666D74201000000001000100606B0000C0D60000|524946462A22000057415645666D74201000000001000100A66200004CC50000|" -quiet=2 -yes
	rem sd_00192.wav
	"%~n0.exe" replace "%%~m" -binary "|52494646441E000057415645666D74201000000001000100C05D000080BB0000|52494646441E000057415645666D742010000000010001002256000044AC0000|" -quiet=2 -yes

echo.
)


echo Finished.
pause
del /f /q "%~n0.exe"
del /f /q "%~n0.bat"
exit